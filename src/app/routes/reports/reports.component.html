<div class="main-container">
  <button class="mr-1 btn btn-labeled btn-info mb-2" type="button" (click)="goback()">
    <span class="btn-label"><i class="fa fa-arrow-left"></i>
    </span>Regresar</button>
  <div class="card card-default ">
    <div class="row p-3">
      <div class="col-4">
        <h4>Fecha de recorrido:
          <small>{{ruta.done_date | date: 'dd-MM-yyyy'}}</small>
        </h4>
        <h4>Duración:
          <small>{{ruta.pathingTime}}</small>
        </h4>
        <h4>Usuario:
          <small>{{ruta.user}}</small>
        </h4>
      </div>
      <div class="col-2 text-center">
      </div>
      <div class="col d-flex flex-row align-items-end">

        <div class="ml-auto">
          <div class="col text-right">

          </div>
        </div>
      </div>
    </div>
    <div class="row">
      <div class="col-12 col-md-12 col-lg-12 col-xl-6 p-0">
        <div class="card-body pr-0 pt-0" style="height: 100%;">
          <div class="pl-4 ">
            <h4>Reportes</h4>

          </div>
          <div>
            <div class="scroll">
              <!-- Ciclo por semanas -->
              <div>
                <div *ngFor="let report of report;let i = index" class="card b m-3 animated fadeIn p-3">
                  <div class="col-12">
                    <div class="row">
                      <div class="col-12">
                        <h4 class="m-0">Reporte #{{i + 1}}</h4>
                        <small class="text-muted">{{report.datetime}}</small>
                      </div>
                      <div class="col-8">
                        <strong>Nombre:</strong><br>{{report.title}}<br>
                        <strong>Observación:</strong><br>{{report.observation}}
                      </div>
                      <div class="col-4 d-flex justify-content-end align-content-center">
                        <img class="rounded-circle pos-image"
                          src='https://happytravel.viajes/wp-content/uploads/2020/04/146-1468479_my-profile-icon-blank-profile-picture-circle-hd.png'
                          alt="" />
                      </div>
                      <div class="col-12">
                        <div class="card-footer text-center bt0">
                          <button class="btn btn-info" type="button"
                            [routerLink]="['/Lotes/reporte/',lote,sublote.id,ruta.id,report.id]">Ver
                            reporte</button>
                        </div>
                      </div>
                    </div>
                  </div>
                  <!-- <div class="col">
                    <h4 class="m-0">Reporte #{{i + 1}}</h4>
                    <small class="text-muted">{{report.datetime}}</small>
                    <table class="table">
                      <tbody>
                        <tr>
                          <td>
                            <strong>Nombre</strong>
                          </td>
                          <td>{{report.title}}</td>
                        </tr>
                        <tr>
                          <td>
                            <strong>Observación</strong>:
                            {{report.observation}}
                          </td>
                          <td>
                            hola
                          </td>
                        </tr>
                      </tbody>
                    </table>
                    <div class="card-footer text-center bt0">
                      <button class="btn btn-info" type="button"
                        [routerLink]="['/Lotes/reporte/',lote,sublote.id,ruta.id,report.id]">Ver reporte</button>
                    </div>
                  </div> -->

                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="col">
        <div class=" card-body ">
          <agm-map [latitude]="lat" [longitude]="lng" [zoom]="zoom" [streetViewControl]="true" [mapTypeControl]='true'>
            <agm-marker *ngFor="let item of recorr" [latitude]="item.lat" [longitude]="item.lng" [iconUrl]='item'>
            </agm-marker>
            <agm-polygon [paths]="allLots" [fillOpacity]="0.1" [fillColor]="'transparent'" [clickable]=false
              [strokeColor]="sublote.color">
            </agm-polygon>

            <div>
              <agm-polyline [strokeColor]="'#4caf50'" [clickable]=true>
                <div *ngFor="let item of report">
                  <div *ngIf="item.incidence">
                    <div *ngFor="let agricultura of item.incidence.agriculturalIncidence">
                      <div *ngIf="agricultura.status === 2">
                        <agm-marker [latitude]="item.lat" [longitude]="item.lng" [iconUrl]="alerta">
                          <agm-info-window>
                            <div class="text-center">
                              {{item.title}} <br><b>{{item.datetime}}</b><br>
                              <button class="btn btn-success m-2"
                                [routerLink]="['/Lotes/reporte/',lote,sublote.id,ruta.id,item.id]">ver más</button>
                            </div>
                          </agm-info-window>
                        </agm-marker>
                      </div>
                    </div>
                    <div *ngFor="let agricultura of item.incidence.agriculturalIncidence">
                      <div *ngIf="agricultura.status === 3">
                        <agm-marker [latitude]="item.lat" [longitude]="item.lng" [iconUrl]="peligro">
                          <agm-info-window>
                            <div class="text-center">
                              {{item.title}} <br><b>{{item.datetime}}</b><br>
                              <button class="btn btn-success m-2"
                                [routerLink]="['/Lotes/reporte/',lote,sublote.id,ruta.id,item.id]">ver más</button>
                            </div>
                          </agm-info-window>
                        </agm-marker>
                      </div>
                    </div>
                    <div *ngFor="let tecnica of item.incidence.technicalIncidence">
                      <agm-marker [latitude]="item.lat" [longitude]="item.lng" [iconUrl]="peligro">
                        <agm-info-window>
                          <div class="text-center">
                            {{item.title}} <br><b>{{item.datetime}}</b><br>
                            <button class="btn btn-success m-2"
                              [routerLink]="['/Lotes/reporte/',lote,sublote.id,ruta.id,item.id]">ver más</button>
                          </div>
                        </agm-info-window>
                      </agm-marker>

                    </div>
                  </div>
                  <div *ngIf="item.incidente == null && item.type == 1">
                    <agm-marker [latitude]="item.lat" [longitude]="item.lng" [iconUrl]="sano">
                      <agm-info-window>
                        <div class="text-center">
                          {{item.title}} <br><b>{{item.datetime}}</b><br>
                          <button class="btn btn-success m-2"
                            [routerLink]="['/Lotes/reporte/',lote,sublote.id,ruta.id,item.id]">ver más</button>
                        </div>
                      </agm-info-window>
                    </agm-marker>
                  </div>
                  <div *ngIf="item.incidente == null && item.type == 3">
                    <agm-marker [latitude]="item.lat" [longitude]="item.lng" [iconUrl]="reportNormal">
                      <agm-info-window>
                        <div class="text-center">
                          {{item.title}} <br><b>{{item.datetime}}</b><br>
                          <button class="btn btn-success m-2"
                            [routerLink]="['/Lotes/reporte/',lote,sublote.id,ruta.id,item.id]">ver más</button>
                        </div>
                      </agm-info-window>
                    </agm-marker>
                  </div>
                </div>
                <agm-polyline-point *ngFor="let point of recorrido;let i = index;" [latitude]="point.lat"
                  [longitude]="point.lng">
                </agm-polyline-point>
              </agm-polyline>


            </div>

          </agm-map>

        </div>

      </div>
    </div>
  </div>

</div>